import { CalculatorContent } from '@/types';

export const MEDICAL_OFFICE_BUILDING_MOB_INVESTMENT_CALCULATOR_CONTENT: CalculatorContent = {
  title: 'Medical Office Building (MOB) Investment Calculator',
  description: 'Calculate ROI and cash flow for medical office building investments with specialized tenant considerations and healthcare market analysis.',
  slug: 'medical-office-building-mob-investment-calculator',
  icon: 'üè•',
  category: 'Investment Analysis',
  article: {
    title: 'Medical Office Building Investment Analysis and Returns',
    content: `
    <h2>Understanding Medical Office Building (MOB) Investments</h2>
    <p>Medical Office Buildings represent a specialized and increasingly attractive segment of commercial real estate. MOBs combine the stability of medical tenants with the growth potential of healthcare demand, making them resilient investments through economic cycles. As healthcare spending continues to rise and the population ages, demand for quality medical office space remains strong.</p>
    
    <h3>What Makes MOBs Unique</h3>
    <p>Medical Office Buildings differ significantly from traditional office properties:</p>
    <ul>
      <li><strong>Specialized Infrastructure:</strong> Enhanced electrical capacity for medical equipment, medical gas systems, specialized HVAC for infection control, wider corridors for patient mobility, and accessible restroom facilities</li>
      <li><strong>Regulatory Requirements:</strong> Compliance with healthcare regulations including HIPAA privacy standards, ADA accessibility, medical waste handling, and state licensing requirements</li>
      <li><strong>Tenant Retention:</strong> Medical practices are sticky tenants with low turnover due to high relocation costs, patient convenience considerations, and established referral networks</li>
      <li><strong>Credit Quality:</strong> Healthcare tenants often have strong credit profiles, especially those affiliated with hospital systems or part of large medical groups</li>
      <li><strong>Essential Service:</strong> Medical care is non-discretionary, providing recession-resistant demand characteristics</li>
    </ul>

    <h3>Types of Medical Office Properties</h3>
    <ul>
      <li><strong>On-Campus MOBs:</strong> Located on or adjacent to hospital campuses. Highest demand location, commanding premium rents due to convenience for physicians and patients. Often benefit from hospital system creditworthiness.</li>
      <li><strong>Off-Campus Suburban MOBs:</strong> Standalone buildings in suburban locations near residential areas. Growing segment as healthcare shifts toward outpatient and convenience care. Lower rents but potentially higher returns.</li>
      <li><strong>Specialty Centers:</strong> Focused on specific medical specialties like surgery centers, imaging centers, dialysis clinics, cancer treatment centers, or diagnostic laboratories. Often single-tenant with specialized build-out.</li>
      <li><strong>Mixed-Use Healthcare Complexes:</strong> Combination of medical office, retail pharmacy, urgent care, and wellness services creating comprehensive healthcare destinations.</li>
      <li><strong>Ambulatory Surgery Centers (ASC):</strong> Outpatient surgical facilities for procedures not requiring overnight hospitalization. Highly specialized with significant equipment and regulatory requirements.</li>
    </ul>

    <h3>Revenue Characteristics</h3>
    <p>MOB revenue streams have distinct features compared to traditional office:</p>
    <ul>
      <li><strong>Triple Net (NNN) Leases:</strong> Most MOB leases are NNN structure where tenants pay base rent plus their proportionate share of property taxes, insurance, and CAM (common area maintenance). Provides landlord with stable, predictable income.</li>
      <li><strong>Long-Term Leases:</strong> Medical tenants typically sign 5-10 year initial terms with multiple 5-year renewal options, providing exceptional income stability.</li>
      <li><strong>Annual Escalations:</strong> Base rent typically increases 2-3% annually or is tied to CPI, protecting against inflation.</li>
      <li><strong>Higher Rents:</strong> MOBs command rent premiums of 20-40% over comparable general office space due to specialized infrastructure and low vacancy.</li>
      <li><strong>Percentage Rent:</strong> Some specialty tenants (imaging centers, ASCs) may pay percentage rent based on gross revenues in addition to base rent.</li>
      <li><strong>Parking Revenue:</strong> On-campus MOBs may generate supplemental income from patient parking, especially in urban locations.</li>
    </ul>

    <h3>Operating Expenses and Considerations</h3>
    <ul>
      <li><strong>Property Taxes:</strong> Based on assessed value. MOBs in some markets may receive favorable classification compared to other commercial properties.</li>
      <li><strong>Insurance:</strong> Medical malpractice concerns and specialized equipment may drive higher property and liability insurance costs. Expect 0.5-1.0% of property value annually.</li>
      <li><strong>CAM Expenses:</strong> Common area maintenance including landscaping, parking lot maintenance, snow removal, security, and common area utilities. Typically $3-8 per square foot annually.</li>
      <li><strong>Management Fees:</strong> Professional property management typically costs 3-5% of effective gross income. Specialized medical property management may command higher fees.</li>
      <li><strong>Reserves:</strong> Capital expenditure reserves for roof, HVAC, parking lot, and major building systems. Budget $0.25-0.50 per square foot annually.</li>
      <li><strong>Medical Waste Disposal:</strong> Specialized handling and disposal of biohazard medical waste for applicable tenants.</li>
      <li><strong>Enhanced Cleaning:</strong> Medical facilities require more frequent and thorough cleaning and disinfection, increasing janitorial costs.</li>
    </ul>

    <h3>Location and Site Selection</h3>
    <p>Location is paramount for MOB success:</p>
    <ul>
      <li><strong>Hospital Proximity:</strong> Properties within 1 mile of hospitals command highest rents and occupancy. Physicians value proximity for hospital privileges and patient referrals.</li>
      <li><strong>Demographics:</strong> Analyze population density, age distribution (especially 65+), and income levels. Aging, affluent populations drive higher healthcare utilization.</li>
      <li><strong>Visibility and Access:</strong> Patients need easy access with good traffic patterns, prominent signage, and convenient parking. Corner locations and major road frontage are premium.</li>
      <li><strong>Parking Ratios:</strong> Medical office requires higher parking ratios than general office (4-5 spaces per 1,000 SF vs. 3-4 for standard office) due to patient traffic.</li>
      <li><strong>Complementary Uses:</strong> Proximity to pharmacy, laboratory services, medical imaging, and retail amenities enhances property value.</li>
    </ul>

    <h3>Tenant Credit Quality Analysis</h3>
    <p>Evaluating tenant creditworthiness is critical for MOB underwriting:</p>
    <ul>
      <li><strong>Hospital-Affiliated Practices:</strong> Highest credit quality. Hospital system guarantees provide institutional-grade credit backing. Often willing to pay premium rents for strategic locations.</li>
      <li><strong>Large Medical Groups:</strong> Multi-specialty groups with 50+ physicians typically have strong financial stability and established patient bases.</li>
      <li><strong>Single-Specialty Groups:</strong> Practices focused on one specialty (orthopedics, cardiology, etc.). Evaluate financial strength, physician credentials, and market position.</li>
      <li><strong>Individual Practitioners:</strong> Solo or small group practices. Higher tenant risk but may accept shorter lease terms and require less TI allowance.</li>
      <li><strong>DSO-Backed Practices:</strong> Dental Support Organizations or similar private equity-backed practice consolidators. Evaluate DSO financial strength and growth strategy.</li>
    </ul>

    <h3>Lease Structure and Tenant Improvements</h3>
    <ul>
      <li><strong>Tenant Improvement (TI) Allowances:</strong> Medical build-outs are expensive, typically $75-150 per square foot for exam rooms, procedure rooms, and specialized equipment. Landlords may provide TI allowances amortized into rent or as upfront capital.</li>
      <li><strong>Base Year Expense Stops:</strong> Alternative to NNN where landlord pays expenses up to a base year amount, tenant pays increases above baseline.</li>
      <li><strong>Exclusive Use Clauses:</strong> Medical tenants often negotiate exclusive use provisions preventing competing specialties in the building.</li>
      <li><strong>Option to Purchase:</strong> Some medical groups negotiate right of first refusal or purchase options to eventually own their space.</li>
      <li><strong>Renewal Options:</strong> Medical tenants typically negotiate multiple 5-year renewal options at predetermined rates or market rates.</li>
    </ul>

    <h3>How to Use This Calculator</h3>
    <p>This calculator helps you analyze MOB investment returns. Enter the following:</p>
    <ul>
      <li><strong>Purchase Price:</strong> Total property acquisition cost</li>
      <li><strong>Building Size (SF):</strong> Net rentable square footage</li>
      <li><strong>Average Rent per SF:</strong> Annual base rent per square foot (typically $24-40 depending on market and quality)</li>
      <li><strong>Occupancy Rate:</strong> Percentage of space leased (stabilized MOBs typically 90-95%)</li>
      <li><strong>Operating Expense Ratio:</strong> Operating expenses as percentage of gross revenue (MOBs typically run 25-35% for NNN properties)</li>
      <li><strong>Annual Rent Growth:</strong> Expected annual rent escalation (2-3% is standard)</li>
      <li><strong>CapEx Reserve:</strong> Annual capital expenditure reserve per SF ($0.25-0.50 typical)</li>
      <li><strong>Down Payment:</strong> Equity investment percentage</li>
      <li><strong>Interest Rate:</strong> Loan interest rate</li>
      <li><strong>Loan Term:</strong> Amortization period</li>
      <li><strong>Holding Period:</strong> Investment time horizon</li>
      <li><strong>Exit Cap Rate:</strong> Expected sale cap rate</li>
    </ul>

    <h3>Key Investment Metrics</h3>
    <ul>
      <li><strong>Net Operating Income (NOI):</strong> Revenue minus operating expenses. Primary valuation metric for commercial real estate.</li>
      <li><strong>Capitalization Rate (Cap Rate):</strong> NOI divided by purchase price. MOBs typically trade at 5.5-8.0% cap rates depending on location, quality, and tenant credit.</li>
      <li><strong>Cash-on-Cash Return:</strong> Annual cash flow divided by equity invested. Strong MOB investments deliver 7-12% cash-on-cash returns.</li>
      <li><strong>Debt Service Coverage Ratio (DSCR):</strong> NOI divided by annual debt payments. Lenders typically require minimum 1.25x DSCR for MOB financing.</li>
      <li><strong>Internal Rate of Return (IRR):</strong> Time-weighted return including cash flows and appreciation. Target 12-18% IRR for value-add MOB investments.</li>
      <li><strong>Occupancy Cost Ratio:</strong> Total rent plus operating expenses as percentage of medical practice revenue. Medical practices typically allocate 6-10% of revenue to occupancy.</li>
    </ul>

    <h3>Financing Medical Office Buildings</h3>
    <ul>
      <li><strong>Traditional Commercial Mortgages:</strong> Banks and credit unions offer 20-25 year amortization, 65-75% LTV, with 5-10 year fixed rates. Require personal guarantees for smaller properties.</li>
      <li><strong>CMBS Loans:</strong> Commercial mortgage-backed securities provide non-recourse financing for institutional-quality MOBs ($5M+ loan size). 10-year fixed rates common.</li>
      <li><strong>Life Insurance Companies:</strong> Conservative long-term lenders preferring high-quality, credit-tenant MOBs in primary markets. May offer 25-30 year amortization.</li>
      <li><strong>SBA 504 Loans:</strong> For owner-occupied medical buildings, SBA 504 program offers up to 90% financing with low down payments. Requires occupancy by owner.</li>
      <li><strong>Healthcare-Focused Lenders:</strong> Specialized lenders understand MOB nuances and may offer more flexible terms for experienced healthcare real estate investors.</li>
    </ul>

    <h3>Risk Factors</h3>
    <ul>
      <li><strong>Regulatory Changes:</strong> Healthcare policy changes, reimbursement rate cuts, or shifting care delivery models can impact tenant viability</li>
      <li><strong>Tenant Concentration:</strong> Properties with single tenant or single specialty face higher risk if that tenant fails or relocates</li>
      <li><strong>Technology Disruption:</strong> Telemedicine and home-based care may reduce demand for certain types of medical office space</li>
      <li><strong>Specialized Build-Out:</strong> Medical improvements have limited alternative use, making re-tenanting more expensive if tenant vacates</li>
      <li><strong>Hospital Dynamics:</strong> Hospital closures, mergers, or strategic shifts can impact affiliated MOB tenant demand</li>
      <li><strong>Functional Obsolescence:</strong> Older MOBs may lack modern infrastructure (fiber connectivity, advanced HVAC, adequate electrical) needed by current medical practices</li>
    </ul>

    <h3>Value-Add Strategies</h3>
    <ul>
      <li><strong>Lease-Up:</strong> Acquiring vacant or partially vacant MOBs and leasing to stable medical tenants creates significant value</li>
      <li><strong>Repositioning:</strong> Renovating dated common areas, upgrading building systems, and modernizing facades to attract quality tenants</li>
      <li><strong>Rent Roll Optimization:</strong> Replacing below-market legacy leases with current market rents through tenant turnover</li>
      <li><strong>Hospital System Partnership:</strong> Partnering with hospital systems to master lease building for their affiliated practices</li>
      <li><strong>Amenity Addition:</strong> Adding pharmacy, cafe, or complementary medical services to enhance property appeal</li>
    </ul>

    <h3>Market Analysis Best Practices</h3>
    <ul>
      <li>Analyze healthcare demographics (age 65+ population growth, chronic disease prevalence)</li>
      <li>Research hospital market share, financial health, and expansion plans</li>
      <li>Inventory competitive MOB supply and pipeline development</li>
      <li>Evaluate reimbursement trends (Medicare/Medicaid rates, managed care penetration)</li>
      <li>Assess physician supply and recruitment patterns</li>
      <li>Consider certificate of need (CON) requirements that may limit new development</li>
    </ul>

    <h3>Due Diligence Checklist</h3>
    <ul>
      <li>Review rent roll with lease abstracts and tenant credit analysis</li>
      <li>Verify building compliance with ADA and healthcare regulations</li>
      <li>Inspect specialized medical systems (medical gas, emergency power, HVAC)</li>
      <li>Review environmental reports for medical waste and hazardous materials</li>
      <li>Analyze historical financials and operating expense trends</li>
      <li>Survey major tenants regarding satisfaction and renewal intentions</li>
      <li>Assess parking adequacy and traffic flow patterns</li>
      <li>Evaluate property condition and deferred maintenance</li>
      <li>Review service contracts for critical systems</li>
      <li>Confirm zoning allows continued medical use</li>
    </ul>

    <h3>Industry Trends</h3>
    <ul>
      <li><strong>Outpatient Migration:</strong> Shift from inpatient to outpatient care driving MOB demand</li>
      <li><strong>Urgent Care Proliferation:</strong> Growth of urgent care and walk-in clinics in retail-adjacent locations</li>
      <li><strong>Telehealth Integration:</strong> Hybrid care models combining in-person and virtual care</li>
      <li><strong>Specialty Migration:</strong> High-acuity specialties (orthopedics, cardiology) increasingly important MOB tenants</li>
      <li><strong>Retail Healthcare:</strong> CVS Health, Walgreens, and retail giants entering primary care space</li>
      <li><strong>ASC Growth:</strong> Ambulatory surgery centers capturing procedures from hospitals</li>
    </ul>
  `,
  },
  calculator: {
    fields: [
      {
        name: 'purchasePrice',
        label: 'Purchase Price',
        type: 'number',
        defaultValue: 8000000,
      },
      {
        name: 'buildingSizeSF',
        label: 'Building Size (Square Feet)',
        type: 'number',
        defaultValue: 40000,
      },
      {
        name: 'rentPerSF',
        label: 'Average Rent per SF (Annual)',
        type: 'number',
        defaultValue: 28,
      },
      {
        name: 'occupancyRate',
        label: 'Occupancy Rate (%)',
        type: 'number',
        defaultValue: 92,
      },
      {
        name: 'operatingExpenseRatio',
        label: 'Operating Expense Ratio (%)',
        type: 'number',
        defaultValue: 30,
      },
      {
        name: 'annualRentGrowth',
        label: 'Annual Rent Growth (%)',
        type: 'number',
        defaultValue: 2.5,
      },
      {
        name: 'capExReserve',
        label: 'CapEx Reserve per SF',
        type: 'number',
        defaultValue: 0.35,
      },
      {
        name: 'downPayment',
        label: 'Down Payment (%)',
        type: 'number',
        defaultValue: 30,
      },
      {
        name: 'interestRate',
        label: 'Interest Rate (%)',
        type: 'number',
        defaultValue: 6.25,
      },
      {
        name: 'loanTerm',
        label: 'Loan Term (Years)',
        type: 'number',
        defaultValue: 25,
      },
      {
        name: 'holdingPeriod',
        label: 'Holding Period (Years)',
        type: 'number',
        defaultValue: 7,
      },
      {
        name: 'exitCapRate',
        label: 'Exit Cap Rate (%)',
        type: 'number',
        defaultValue: 6.75,
      },
    ],
    results: [
      { label: 'Gross Potential Rent', isCurrency: true },
      { label: 'Effective Gross Income', isCurrency: true },
      { label: 'Year 1 NOI', isCurrency: true },
      { label: 'Year 1 Cash Flow', isCurrency: true },
      { label: 'Cash-on-Cash Return', isPercentage: true },
      { label: 'Going-In Cap Rate', isPercentage: true },
      { label: 'DSCR', isText: true },
      { label: 'Projected Sale Price', isCurrency: true },
      { label: 'Total Return', isCurrency: true },
      { label: 'IRR', isPercentage: true },
      { label: 'Equity Multiple', isText: true },
    ],
    calculate: (values) => {
      const {
        purchasePrice,
        buildingSizeSF,
        rentPerSF,
        occupancyRate,
        operatingExpenseRatio,
        annualRentGrowth,
        capExReserve,
        downPayment,
        interestRate,
        loanTerm,
        holdingPeriod,
        exitCapRate,
      } = values;

      const grossPotentialRent = buildingSizeSF * rentPerSF;
      const effectiveGrossIncome = grossPotentialRent * (occupancyRate / 100);
      const operatingExpenses = effectiveGrossIncome * (operatingExpenseRatio / 100);
      const capExReserveAmount = buildingSizeSF * capExReserve;
      const year1NOI = effectiveGrossIncome - operatingExpenses - capExReserveAmount;

      const loanAmount = purchasePrice * (1 - downPayment / 100);
      const monthlyRate = interestRate / 100 / 12;
      const numPayments = loanTerm * 12;
      const monthlyPayment =
        (loanAmount * monthlyRate * Math.pow(1 + monthlyRate, numPayments)) /
        (Math.pow(1 + monthlyRate, numPayments) - 1);
      const annualDebtService = monthlyPayment * 12;

      const year1CashFlow = year1NOI - annualDebtService;
      const equity = purchasePrice * (downPayment / 100);
      const cashOnCash = (year1CashFlow / equity) * 100;
      const capRate = (year1NOI / purchasePrice) * 100;
      const dscr = year1NOI / annualDebtService;

      let currentNOI = year1NOI;
      let totalCashFlow = 0;
      const cashFlows = [-equity];

      for (let year = 1; year <= holdingPeriod; year++) {
        if (year > 1) {
          currentNOI = currentNOI * (1 + annualRentGrowth / 100);
        }
        const yearCashFlow = currentNOI - annualDebtService;
        totalCashFlow += yearCashFlow;
        cashFlows.push(yearCashFlow);
      }

      const salePrice = currentNOI / (exitCapRate / 100);
      const remainingBalance =
        loanAmount *
        (Math.pow(1 + monthlyRate, numPayments) -
          Math.pow(1 + monthlyRate, holdingPeriod * 12)) /
        (Math.pow(1 + monthlyRate, numPayments) - 1);
      const saleProceeds = salePrice - remainingBalance;
      cashFlows[cashFlows.length - 1] += saleProceeds;

      const totalReturn = totalCashFlow + saleProceeds - equity;

      function calculateIRR(flows: number[]): number {
        let rate = 0.1;
        const maxIter = 1000;
        const tolerance = 0.00001;

        for (let i = 0; i < maxIter; i++) {
          let npv = 0;
          let dnpv = 0;

          for (let j = 0; j < flows.length; j++) {
            npv += flows[j] / Math.pow(1 + rate, j);
            dnpv += (-j * flows[j]) / Math.pow(1 + rate, j + 1);
          }

          const newRate = rate - npv / dnpv;
          if (Math.abs(newRate - rate) < tolerance) {
            return newRate * 100;
          }
          rate = newRate;
        }
        return rate * 100;
      }

      const irr = calculateIRR(cashFlows);
      const equityMultiple = (totalCashFlow + saleProceeds) / equity;

      return [
        { label: 'Gross Potential Rent', value: grossPotentialRent.toFixed(2), isCurrency: true },
        { label: 'Effective Gross Income', value: effectiveGrossIncome.toFixed(2), isCurrency: true },
        { label: 'Year 1 NOI', value: year1NOI.toFixed(2), isCurrency: true },
        { label: 'Year 1 Cash Flow', value: year1CashFlow.toFixed(2), isCurrency: true },
        { label: 'Cash-on-Cash Return', value: cashOnCash.toFixed(2), isPercentage: true },
        { label: 'Going-In Cap Rate', value: capRate.toFixed(2), isPercentage: true },
        { label: 'DSCR', value: `${dscr.toFixed(2)}x`, isText: true },
        { label: 'Projected Sale Price', value: salePrice.toFixed(2), isCurrency: true },
        { label: 'Total Return', value: totalReturn.toFixed(2), isCurrency: true },
        { label: 'IRR', value: irr.toFixed(2), isPercentage: true },
        { label: 'Equity Multiple', value: `${equityMultiple.toFixed(2)}x`, isText: true },
      ];
    },
  },
};
