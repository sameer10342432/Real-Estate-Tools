import { CalculatorContent } from "@/types";

export const OFFICE_BUILDING_INVESTMENT_CALCULATOR_CONTENT: CalculatorContent = {
  title: "Office Building Investment Calculator",
  description: "Evaluate office building investments with tenant mix analysis, lease structures, and comprehensive financial modeling.",
  icon: "Icon",
  category: "Real Estate",
  slug: "office-building-investment-calculator",
  article: {
    title: "Office Building Investment Calculator - Commercial Office Property Analysis",
    content: `
    An office building investment calculator helps investors analyze commercial office properties from small professional buildings to large multi-tenant office towers.

    ### Understanding Office Building Investments

    Office properties represent a major commercial real estate sector with unique characteristics:

    - **Lease terms:** Typically 3-10 years
    - **Tenant improvements:** Significant upfront costs ($20-$80 per SF)
    - **Operating structure:** Usually triple net or modified gross
    - **Management:** Professional management required
    - **Market sensitivity:** Correlated with employment and economic cycles

    ### Office Building Classifications

    **Class A**
    - Premium locations (CBD, prestigious suburbs)
    - Newest construction or fully renovated
    - High-quality finishes and systems
    - Professional management
    - Rent: $35-$80+ per SF
    - Typical tenants: Law firms, Fortune 500, finance

    **Class B**
    - Good locations, mid-age buildings
    - Functional but not premium
    - Standard systems and finishes
    - Rent: $20-$35 per SF
    - Typical tenants: Mid-sized companies, professional services

    **Class C**
    - Older buildings (20+ years)
    - Lower-rent locations
    - Basic finishes, dated systems
    - Rent: $12-$20 per SF
    - Typical tenants: Start-ups, back-office, non-profits

    ### Office Property Types

    **Single-Tenant Buildings**
    - One tenant occupies entire building
    - Long-term lease (10-20 years)
    - Minimal management
    - Higher risk if tenant leaves
    - Often corporate headquarters

    **Multi-Tenant Buildings**
    - Multiple tenants of varying sizes
    - Staggered lease expirations
    - More management intensive
    - Lower vacancy risk
    - Requires active leasing

    **Medical Office Buildings**
    - Healthcare tenants
    - Specialized buildouts
    - Strong demand in aging demographics
    - Higher TI costs
    - Stable, credit-worthy tenants

    **Flex/R&D Space**
    - Combination office/warehouse
    - Tech and light industrial tenants
    - Lower finish costs
    - Growing demand
    - Higher ceilings, loading capability

    ### Key Performance Metrics

    **1. Net Operating Income (NOI)**
    Total income minus operating expenses (before debt service)

    **2. Cap Rate**
    NOI ÷ Purchase Price. Office cap rates: 5-9% depending on market and class

    **3. Cash-on-Cash Return**
    Annual cash flow ÷ Total cash invested. Target: 8-12%

    **4. Debt Service Coverage Ratio (DSCR)**
    NOI ÷ Annual debt service. Lenders require: 1.25-1.35x minimum

    **5. Occupancy Rate**
    Percentage of leasable space occupied. Healthy: 90-95%+

    **6. Average Lease Term**
    Weighted average remaining lease term. Longer is more stable.

    ### Revenue Streams

    **Base Rent**
    Primary income, typically quoted per SF annually
    - Gross rent: Landlord pays operating costs
    - Modified gross: Tenant pays some costs
    - Triple net: Tenant pays all costs

    **Operating Expense Recoveries**
    - CAM (Common Area Maintenance)
    - Property taxes
    - Insurance
    - Utilities (if not directly metered)

    **Parking Income**
    - Reserved spaces: $75-$250/month
    - Daily/hourly parking
    - Visitor parking fees

    **Other Income**
    - Antenna/cell tower leases
    - Signage fees
    - Conference room rentals
    - Vending and convenience services

    ### Operating Expenses

    **Property Management**
    3-5% of effective gross income

    **Utilities**
    $2-$5 per SF (if landlord-paid)
    - Electricity, gas, water, sewer

    **Janitorial/Cleaning**
    $1.50-$3 per SF annually

    **Repairs & Maintenance**
    $1-$3 per SF annually
    - HVAC service
    - Elevator maintenance
    - Building systems
    - Landscaping

    **Insurance**
    $0.50-$1.50 per SF

    **Property Taxes**
    Varies by jurisdiction (often passed through)

    **Security**
    $0.50-$2 per SF (for larger buildings)

    **Capital Reserves**
    5-10% of gross income for:
    - Roof replacement
    - HVAC systems
    - Elevator modernization
    - Parking lot resurfacing
    - Building systems upgrades

    ### Lease Structures

    **Full-Service Gross (FSG)**
    Landlord pays all operating expenses
    - Tenant pays one rent amount
    - Landlord bears expense risk
    - Common in CBD Class A

    **Modified Gross**
    Base year or expense stop
    - Landlord pays expenses up to base amount
    - Tenant pays increases above base
    - Most common office lease type

    **Triple Net (NNN)**
    Tenant pays pro-rata share of:
    - Property taxes
    - Insurance
    - CAM (Common Area Maintenance)
    - Plus base rent
    - Common in suburban office

    ### Tenant Improvement Allowances

    **New Leases:**
    - Class A: $40-$80 per SF
    - Class B: $20-$40 per SF
    - Class C: $10-$25 per SF

    **Renewals:**
    - 25-50% of new lease TI

    **Work Letter Improvements:**
    - Paint and carpet
    - Lighting
    - Electrical/data
    - Partitions and doors
    - Reception areas

    ### Leasing Commissions

    **New Leases:**
    - 4-6% of total lease value
    - Split between tenant and landlord brokers

    **Renewals:**
    - 2-3% of total lease value

    **Example:**
    5-year lease at $25/SF for 5,000 SF = $625,000 total
    Commission at 5% = $31,250

    ### Value-Add Strategies

    **Increase Rental Income:**
    - Renovate common areas and lobby
    - Upgrade building systems
    - Add amenities (fitness center, café, conference rooms)
    - Improve signage and curb appeal
    - Implement below-market rent to market
    - Convert unused space (storage to leasable)

    **Reduce Operating Expenses:**
    - LED lighting retrofit (30-40% energy savings)
    - HVAC optimization and controls
    - Solar panels or renewable energy
    - Renegotiate service contracts
    - Implement preventive maintenance

    **Improve Occupancy:**
    - Hire experienced leasing broker
    - Offer flexible lease terms
    - Provide move-in ready suites
    - Target growing industries
    - Flexible space for coworking

    ### Market Trends Affecting Office

    **Remote Work Impact:**
    - Flight to quality (Class A outperforming)
    - Demand for flexible space
    - Preference for amenity-rich buildings
    - Suburban office resurgence

    **Tenant Preferences:**
    - Open floor plans and collaboration spaces
    - Natural light and outdoor access
    - Wellness features (air quality, fitness)
    - Technology infrastructure (high-speed internet)
    - Sustainability and LEED certification

    **Adaptive Reuse:**
    - Converting obsolete office to residential
    - Mixed-use development
    - Life science conversions
    - Data center conversions

    ### Due Diligence Checklist

    **Financial Analysis:**
    - 3+ years operating statements
    - Detailed rent roll with lease abstracts
    - Lease expiration schedule
    - Historical occupancy trends
    - Operating expense reconciliations
    - Delinquency reports

    **Physical Inspection:**
    - Roof age and condition
    - HVAC systems (life expectancy)
    - Elevator compliance and condition
    - Parking lot and structure
    - Building envelope and windows
    - ADA compliance
    - Asbestos and environmental

    **Market Analysis:**
    - Submarket vacancy rates
    - Competitive properties and rents
    - Employment trends
    - New construction pipeline
    - Transportation and amenities

    **Legal Review:**
    - Title and survey
    - Zoning compliance
    - Lease guarantees
    - Tenant estoppels
    - Service contracts

    ### Financing Office Buildings

    **Conventional Loans:**
    - 25-35% down payment
    - Interest rates: 6-9%
    - Terms: 5-10 years
    - Amortization: 20-30 years
    - Requires 1.25x DSCR minimum

    **Agency Loans (Fannie Mae/Freddie Mac):**
    - Best rates for larger buildings
    - Non-recourse options
    - 65-75% LTV
    - Stricter underwriting

    **Life Insurance Companies:**
    - Conservative long-term lenders
    - Best for Class A, stable properties
    - 10-year+ fixed rates
    - Lower leverage (60-65% LTV)

    ### Investment Risks

    **Concentration Risk:**
    Large tenant representing >30% of income creates risk

    **Lease Rollover Risk:**
    Multiple leases expiring simultaneously

    **Obsolescence Risk:**
    Older buildings may need significant capital

    **Economic Sensitivity:**
    Office demand tied to employment and economic cycles

    **Remote Work:**
    Changing workplace dynamics affecting demand

    ### Common Investment Mistakes

    **Overpaying Based on Pro Forma:**
    Use actual in-place rents, not projections

    **Underestimating TI and Leasing Costs:**
    Budget 15-20% of rent for these costs

    **Ignoring Capital Expenditures:**
    Roof, HVAC, elevator, parking lot—all expensive

    **Buying in Declining Markets:**
    High vacancy, negative absorption, falling rents

    **Insufficient Reserves:**
    Maintain 6-12 months operating reserves

    ### How This Calculator Works

    This calculator provides:

    1. **Gross Income:** From rent and expense recoveries
    2. **Net Operating Income:** After operating expenses
    3. **Cash Flow:** After debt service
    4. **ROI Metrics:** Cap rate, cash-on-cash, DSCR
    5. **Per SF Analysis:** Income and expenses per SF
    6. **Break-Even Occupancy:** Minimum occupancy required

    Use this calculator to model office building investments, compare opportunities, and make data-driven decisions based on market fundamentals and property-specific factors.
  `,
  },
  calculator: {
    fields: [
      {
        name: "purchasePrice",
        label: "Purchase Price",
        type: "number",
        defaultValue: "8000000",
      },
      {
        name: "totalSquareFeet",
        label: "Total Leasable Square Feet",
        type: "number",
        defaultValue: "60000",
      },
      {
        name: "occupancyRate",
        label: "Occupancy Rate (%)",
        type: "number",
        defaultValue: "88",
      },
      {
        name: "averageRentPerSF",
        label: "Average Base Rent (per SF annually)",
        type: "number",
        defaultValue: "28",
      },
      {
        name: "expenseRecoveries",
        label: "Operating Expense Recoveries (per SF annually)",
        type: "number",
        defaultValue: "8",
      },
      {
        name: "parkingIncome",
        label: "Annual Parking Income",
        type: "number",
        defaultValue: "180000",
      },
      {
        name: "otherIncome",
        label: "Annual Other Income",
        type: "number",
        defaultValue: "40000",
      },
      {
        name: "propertyManagement",
        label: "Property Management (% of Gross Income)",
        type: "number",
        defaultValue: "4",
      },
      {
        name: "utilities",
        label: "Annual Utilities",
        type: "number",
        defaultValue: "180000",
      },
      {
        name: "janitorial",
        label: "Annual Janitorial",
        type: "number",
        defaultValue: "120000",
      },
      {
        name: "maintenance",
        label: "Annual Maintenance & Repairs",
        type: "number",
        defaultValue: "100000",
      },
      {
        name: "insurance",
        label: "Annual Insurance",
        type: "number",
        defaultValue: "60000",
      },
      {
        name: "propertyTaxes",
        label: "Annual Property Taxes",
        type: "number",
        defaultValue: "160000",
      },
      {
        name: "security",
        label: "Annual Security",
        type: "number",
        defaultValue: "50000",
      },
      {
        name: "capexReserve",
        label: "CapEx Reserve (% of Gross Income)",
        type: "number",
        defaultValue: "8",
      },
      {
        name: "downPayment",
        label: "Down Payment",
        type: "number",
        defaultValue: "2400000",
      },
      {
        name: "interestRate",
        label: "Loan Interest Rate (%)",
        type: "number",
        defaultValue: "7.25",
      },
      {
        name: "loanTerm",
        label: "Loan Term (Years)",
        type: "number",
        defaultValue: "25",
      },
      {
        name: "closingCosts",
        label: "Closing Costs",
        type: "number",
        defaultValue: "160000",
      },
    ],
    results: [
      { label: "Occupied Square Feet", isCurrency: false },
      { label: "Gross Annual Rental Income", isCurrency: true },
      { label: "Total Annual Income", isCurrency: true },
      { label: "Total Operating Expenses", isCurrency: true },
      { label: "Net Operating Income (NOI)", isCurrency: true },
      { label: "Annual Debt Service", isCurrency: true },
      { label: "Annual Cash Flow", isCurrency: true },
      { label: "Total Cash Invested", isCurrency: true },
      { label: "Cap Rate", isCurrency: false },
      { label: "Cash-on-Cash Return", isCurrency: false },
      { label: "Debt Service Coverage Ratio (DSCR)", isCurrency: false },
      { label: "NOI per Square Foot", isCurrency: true },
      { label: "Break-Even Occupancy", isCurrency: false },
    ],
    calculate: (values) => {
      const {
        purchasePrice, totalSquareFeet, occupancyRate, averageRentPerSF,
        expenseRecoveries, parkingIncome, otherIncome,
        propertyManagement, utilities, janitorial, maintenance, insurance, propertyTaxes, security, capexReserve,
        downPayment, interestRate, loanTerm, closingCosts
      } = values;
      
      const occupiedSquareFeet = totalSquareFeet * (occupancyRate / 100);
      const grossRentalIncome = occupiedSquareFeet * averageRentPerSF;
      const expenseRecoveryIncome = occupiedSquareFeet * expenseRecoveries;
      const totalAnnualIncome = grossRentalIncome + expenseRecoveryIncome + parkingIncome + otherIncome;
      
      const managementFees = totalAnnualIncome * (propertyManagement / 100);
      const capexReserves = totalAnnualIncome * (capexReserve / 100);
      const totalOperatingExpenses = managementFees + utilities + janitorial + maintenance + insurance + propertyTaxes + security + capexReserves;
      const noi = totalAnnualIncome - totalOperatingExpenses;
      
      const loanAmount = purchasePrice - downPayment;
      const monthlyRate = interestRate / 100 / 12;
      const numberOfPayments = loanTerm * 12;
      const monthlyPayment = loanAmount * (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)) / (Math.pow(1 + monthlyRate, numberOfPayments) - 1);
      const annualDebtService = monthlyPayment * 12;
      
      const annualCashFlow = noi - annualDebtService;
      const totalCashInvested = downPayment + closingCosts;
      const capRate = (noi / purchasePrice) * 100;
      const cashOnCashReturn = (annualCashFlow / totalCashInvested) * 100;
      const dscr = noi / annualDebtService;
      const noiPerSF = noi / totalSquareFeet;
      
      const breakEvenOccupancy = ((totalOperatingExpenses + annualDebtService) / (totalSquareFeet * (averageRentPerSF + expenseRecoveries))) * 100;

      return [
        { label: "Occupied Square Feet", value: occupiedSquareFeet.toFixed(0), isCurrency: false },
        { label: "Gross Annual Rental Income", value: grossRentalIncome.toFixed(2), isCurrency: true },
        { label: "Total Annual Income", value: totalAnnualIncome.toFixed(2), isCurrency: true },
        { label: "Total Operating Expenses", value: totalOperatingExpenses.toFixed(2), isCurrency: true },
        { label: "Net Operating Income (NOI)", value: noi.toFixed(2), isCurrency: true },
        { label: "Annual Debt Service", value: annualDebtService.toFixed(2), isCurrency: true },
        { label: "Annual Cash Flow", value: annualCashFlow.toFixed(2), isCurrency: true },
        { label: "Total Cash Invested", value: totalCashInvested.toFixed(2), isCurrency: true },
        { label: "Cap Rate", value: `${capRate.toFixed(2)}%`, isCurrency: false },
        { label: "Cash-on-Cash Return", value: `${cashOnCashReturn.toFixed(2)}%`, isCurrency: false },
        { label: "Debt Service Coverage Ratio (DSCR)", value: `${dscr.toFixed(2)}x`, isCurrency: false },
        { label: "NOI per Square Foot", value: noiPerSF.toFixed(2), isCurrency: true },
        { label: "Break-Even Occupancy", value: `${breakEvenOccupancy.toFixed(2)}%`, isCurrency: false },
      ];
    },
  },
};
