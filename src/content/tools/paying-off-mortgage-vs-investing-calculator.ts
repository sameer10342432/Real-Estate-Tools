import { CalculatorContent } from '@/types';

export const PAYING_OFF_MORTGAGE_VS_INVESTING_CALCULATOR_CONTENT: CalculatorContent = {
  title: 'Paying Off Mortgage vs. Investing Calculator',
  description: 'Compare financial outcomes of paying off your mortgage early versus investing extra payments in the stock market or real estate.',
  icon: 'Icon',
  category: 'Financial Planning',
  slug: 'paying-off-mortgage-vs-investing-calculator',
  metaTitle: 'Pay Off Mortgage Early or Invest? Calculator & Strategy Guide',
  metaDescription: 'Should you pay off your mortgage early or invest the money? Calculate returns, tax implications, and risk-adjusted outcomes to make the best financial decision.',
  article: {
    title: "Pay Off Mortgage or Invest: The $200,000 Decision",
    content: `
    <h2>The Great Debate: Mortgage Freedom vs. Wealth Building</h2>
    <p>You have an extra $500/month. Should you pay down your 4% mortgage or invest in the stock market earning 8%? This decision can impact your net worth by hundreds of thousands of dollars over 20-30 years.</p>
    
    <h3>The Pure Math Answer</h3>
    <p>Mathematically, if investment returns exceed mortgage interest rate (after accounting for the tax deduction), you should invest. But real life involves psychology, risk, and circumstances that pure math ignores.</p>
    
    <h4>Example: $500/Month for 20 Years</h4>
    <table>
      <tr>
        <th>Strategy</th>
        <th>Result</th>
        <th>Net Worth Impact</th>
      </tr>
      <tr>
        <td>Pay Off 4% Mortgage Early</td>
        <td>Save $35,000 in interest, own home in 20 years</td>
        <td>$400,000 (home equity)</td>
      </tr>
      <tr>
        <td>Invest in 8% Stock Market</td>
        <td>$500/mo @ 8% = $294,000 in 20 years</td>
        <td>$694,000 (stocks + home)</td>
      </tr>
      <tr>
        <td>Difference</td>
        <td>Investing wins by $294,000</td>
        <td>73% more wealth</td>
      </tr>
    </table>
    
    <p><strong>But this ignores taxes, risk, psychology, and life circumstances.</strong></p>
    
    <h3>The Tax Deduction Factor</h3>
    
    <h4>Mortgage Interest Deduction</h4>
    <p>Since the 2017 Tax Cuts and Jobs Act, far fewer people benefit from mortgage interest deduction:</p>
    <ul>
      <li><strong>Standard Deduction (2024):</strong> $14,600 single / $29,200 married</li>
      <li><strong>Who Benefits:</strong> Only if mortgage interest + property taxes + other deductions exceed standard deduction</li>
      <li><strong>Reality:</strong> Only ~15% of homeowners itemize (down from 30% pre-2017)</li>
    </ul>
    
    <h4>Effective Mortgage Rate After Tax</h4>
    <p>If you DO itemize and are in the 24% tax bracket:</p>
    <ul>
      <li>4% mortgage rate × (1 - 0.24 tax bracket) = 3.04% effective rate</li>
      <li>This makes investing more attractive (8% return vs. 3% cost)</li>
    </ul>
    
    <h4>If You DON'T Itemize</h4>
    <p>Your mortgage interest has ZERO tax benefit. The decision becomes 4% guaranteed "return" (paying off mortgage) vs. 8% uncertain return (investing).</p>
    
    <h3>The Risk-Adjusted Analysis</h3>
    
    <h4>Paying Off Mortgage</h4>
    <ul>
      <li><strong>Risk Level:</strong> Zero (guaranteed return = your interest rate)</li>
      <li><strong>Return:</strong> 4% (risk-free)</li>
      <li><strong>Volatility:</strong> None</li>
      <li><strong>Liquidity:</strong> Low (money locked in home equity)</li>
    </ul>
    
    <h4>Investing in Stock Market</h4>
    <ul>
      <li><strong>Risk Level:</strong> Moderate to High</li>
      <li><strong>Average Return:</strong> 10% (historical S&P 500)</li>
      <li><strong>Volatility:</strong> Can drop 20-50% in bear markets</li>
      <li><strong>Liquidity:</strong> High (sell anytime)</li>
    </ul>
    
    <h4>Risk-Adjusted Perspective</h4>
    <p>Paying off a 4% mortgage is equivalent to a guaranteed 4% return. To find a truly risk-free 4% return elsewhere requires buying long-term Treasury bonds, which have interest rate risk.</p>
    
    <h3>When to Pay Off Mortgage Early</h3>
    
    <h4>Strong Case for Paying Off Mortgage</h4>
    <ul>
      <li><strong>High Interest Rate:</strong> Mortgage above 6% (free up cash flow faster)</li>
      <li><strong>Near Retirement:</strong> Eliminate fixed expense before income drops</li>
      <li><strong>Risk-Averse Personality:</strong> Sleep-at-night factor matters</li>
      <li><strong>Poor Investment Discipline:</strong> Would spend money instead of investing it</li>
      <li><strong>No Emergency Fund:</strong> Reduce monthly obligations first</li>
      <li><strong>Unstable Income:</strong> Freelancer, commission-based, business owner</li>
      <li><strong>Peace of Mind:</strong> Psychological benefit of being debt-free</li>
    </ul>
    
    <h4>Life Scenario: Sarah's Story</h4>
    <p>Sarah, 55, has a $180,000 mortgage at 5% with 15 years left. Monthly payment: $1,423. She's planning to retire at 65.</p>
    <ul>
      <li>If she pays it off in 10 years (extra $500/mo): House free and clear at retirement</li>
      <li>Retirement expenses drop by $1,423/month</li>
      <li>Needs $342,000 less in retirement savings (using 4% rule: $1,423 × 12 / 0.04)</li>
      <li><strong>Verdict:</strong> Paying off mortgage makes sense for near-retirees</li>
    </ul>
    
    <h3>When to Invest Instead</h3>
    
    <h4>Strong Case for Investing</h4>
    <ul>
      <li><strong>Low Interest Rate:</strong> Mortgage under 4% (especially 2020-2021 refis at 2.5-3.5%)</li>
      <li><strong>Young (20s-30s):</strong> Decades of compound growth ahead</li>
      <li><strong>High Risk Tolerance:</strong> Can handle market volatility</li>
      <li><strong>Strong Financial Foundation:</strong> 6-month emergency fund, maxing 401k match</li>
      <li><strong>Tax Benefits:</strong> Mortgage interest deduction + capital gains treatment on investments</li>
      <li><strong>Employer Match:</strong> Get free money (50-100% return) on 401k</li>
    </ul>
    
    <h4>Life Scenario: Mark's Story</h4>
    <p>Mark, 28, has a $300,000 mortgage at 3.25% (2021 refi). Extra $500/month available.</p>
    <ul>
      <li>Option 1: Pay off mortgage → saves $85,000 in interest, owns home at 47</li>
      <li>Option 2: Invest $500/mo @ 8% for 30 years → $748,000</li>
      <li><strong>Verdict:</strong> Investing wins by $663,000 for young investors with low rates</li>
    </ul>
    
    <h3>The Hybrid Strategy (Best for Most People)</h3>
    
    <h4>The Balanced Approach</h4>
    <ol>
      <li><strong>Build Emergency Fund:</strong> 6 months expenses in savings (first priority)</li>
      <li><strong>Get 401k Match:</strong> Contribute enough for full employer match (50-100% instant return)</li>
      <li><strong>Pay Off High-Interest Debt:</strong> Credit cards, personal loans above 6%</li>
      <li><strong>Split Extra Cash:</strong> 50% to investments, 50% to mortgage principal</li>
      <li><strong>Adjust Based on Age:</strong> Shift more toward mortgage payoff as you near retirement</li>
    </ol>
    
    <h4>Example: $1,000/Month Extra Cash</h4>
    <ul>
      <li>$500 to S&P 500 index fund</li>
      <li>$500 extra principal payment on mortgage</li>
      <li>Result: Build wealth AND reduce debt burden</li>
      <li>Psychological win: Progress on both goals</li>
    </ul>
    
    <h3>The Liquidity Argument</h3>
    
    <h4>Problem with Paying Off Mortgage</h4>
    <p>Money paid toward principal is locked in home equity. You can't access it unless you:</p>
    <ul>
      <li>Sell the home (slow, expensive)</li>
      <li>Open a HELOC (requires qualification, has interest)</li>
      <li>Cash-out refinance (fees, new loan terms)</li>
    </ul>
    
    <h4>Investments Are Liquid</h4>
    <p>Stocks/bonds can be sold in 2-3 days if you need cash for:</p>
    <ul>
      <li>Medical emergency</li>
      <li>Job loss</li>
      <li>Business opportunity</li>
      <li>Family emergency</li>
    </ul>
    
    <p><strong>Recommendation:</strong> Keep 6-12 months expenses in investments before aggressively paying off mortgage.</p>
    
    <h3>The Opportunity Cost Consideration</h3>
    
    <h4>Real Estate Investing Alternative</h4>
    <p>Instead of paying off your 4% primary residence mortgage, use extra cash to buy rental property:</p>
    <ul>
      <li>Generate 8-12% cash-on-cash returns</li>
      <li>Build separate asset</li>
      <li>Tax benefits (depreciation, expense deductions)</li>
      <li>Appreciation + cash flow + loan paydown</li>
    </ul>
    
    <h4>Example: $20,000 Saved Over 2 Years</h4>
    <p><strong>Option A:</strong> Pay $20k toward mortgage principal → saves $12,000 in interest over loan life</p>
    <p><strong>Option B:</strong> Use $20k as down payment on $100k rental property → generates $400/mo cash flow = $4,800/year forever</p>
    
    <h3>The Behavior Economics Factor</h3>
    
    <h4>Forced Savings Effect</h4>
    <p>Paying extra toward mortgage = forced savings (you can't easily waste it). Keeps money away from lifestyle inflation.</p>
    
    <h4>Market Timing Risk</h4>
    <p>Investors who started in 2000 or 2007 (peak before crashes) saw negative returns for years. Mortgage payoff would have won during those periods.</p>
    
    <h4>The Counterfactual</h4>
    <p>Ask yourself honestly: <em>If I don't pay off the mortgage, will I actually invest the money?</em> Or will it go toward:</p>
    <ul>
      <li>Car upgrades</li>
      <li>Vacations</li>
      <li>Restaurants and entertainment</li>
      <li>Lifestyle creep</li>
    </ul>
    <p>If you lack investment discipline, paying off mortgage forces wealth building.</p>
    
    <h3>Mortgage Payoff Strategies</h3>
    
    <h4>Strategy 1: Extra Payment Each Month</h4>
    <p>Add fixed amount to principal every month (e.g., round up payment from $1,200 to $1,500)</p>
    
    <h4>Strategy 2: Biweekly Payments</h4>
    <p>Pay half your mortgage every 2 weeks = 26 half-payments = 13 full payments per year instead of 12. Shaves 4-7 years off 30-year mortgage.</p>
    
    <h4>Strategy 3: Annual Lump Sum</h4>
    <p>Use tax refund, bonus, or windfall for one large principal payment each year.</p>
    
    <h4>Strategy 4: Recast (Not Refinance)</h4>
    <p>Pay lump sum, bank recalculates monthly payment based on new lower principal. Keeps same interest rate and term, but lowers required payment (fee: $150-500).</p>
    
    <h3>Tax Implications Summary</h3>
    <table>
      <tr>
        <th>Strategy</th>
        <th>Tax Treatment</th>
        <th>Benefit</th>
      </tr>
      <tr>
        <td>Pay Off Mortgage</td>
        <td>No tax benefit (if taking standard deduction)</td>
        <td>Guaranteed return = interest rate</td>
      </tr>
      <tr>
        <td>Taxable Investment Account</td>
        <td>Pay taxes on dividends annually, capital gains when sold</td>
        <td>Long-term cap gains = 15-20% (better than ordinary income)</td>
      </tr>
      <tr>
        <td>401k/IRA</td>
        <td>Tax-deferred growth, taxed at withdrawal</td>
        <td>Reduce current taxable income</td>
      </tr>
      <tr>
        <td>Roth IRA</td>
        <td>After-tax contributions, tax-free growth & withdrawals</td>
        <td>No taxes ever (best long-term)</td>
      </tr>
    </table>
    
    <h3>Final Recommendation Framework</h3>
    
    <h4>Pay Off Mortgage If:</h4>
    <ul>
      <li>Interest rate > 6%</li>
      <li>Within 10 years of retirement</li>
      <li>Risk-averse personality</li>
      <li>No emergency fund yet</li>
      <li>Variable/unstable income</li>
    </ul>
    
    <h4>Invest If:</h4>
    <ul>
      <li>Interest rate < 4%</li>
      <li>20+ years until retirement</li>
      <li>Strong emergency fund (6+ months)</li>
      <li>Maxing out 401k match</li>
      <li>Comfortable with market volatility</li>
    </ul>
    
    <h4>Do Both If:</h4>
    <ul>
      <li>Interest rate 4-6%</li>
      <li>10-20 years until retirement</li>
      <li>Moderate risk tolerance</li>
      <li>Want psychological diversification</li>
    </ul>
  `,
  },
  calculator: {
    fields: [
      {
        name: "mortgageBalance",
        label: "Current Mortgage Balance",
        type: "number",
        placeholder: "250000",
        defaultValue: "250000",
      },
      {
        name: "interestRate",
        label: "Mortgage Interest Rate (%)",
        type: "number",
        placeholder: "4.5",
        defaultValue: "4.5",
      },
      {
        name: "yearsRemaining",
        label: "Years Remaining on Mortgage",
        type: "number",
        placeholder: "25",
        defaultValue: "25",
      },
      {
        name: "extraMonthlyPayment",
        label: "Extra Monthly Payment Available",
        type: "number",
        placeholder: "500",
        defaultValue: "500",
      },
      {
        name: "investmentReturn",
        label: "Expected Investment Return (%)",
        type: "number",
        placeholder: "8",
        defaultValue: "8",
      },
      {
        name: "taxBracket",
        label: "Your Tax Bracket (%)",
        type: "number",
        placeholder: "24",
        defaultValue: "24",
      },
      {
        name: "itemizeDeductions",
        label: "Do You Itemize Deductions?",
        type: "boolean",
        defaultValue: false,
      },
    ],
    results: [
      { label: "Mortgage: Interest Saved by Extra Payments", isCurrency: true },
      { label: "Mortgage: Years Saved", isCurrency: false },
      { label: "Mortgage: Total Paid with Extra Payments", isCurrency: true },
      { label: "Mortgage: After-Tax Effective Rate (%)", isCurrency: false },
      { label: "Investing: Account Value at End", isCurrency: true },
      { label: "Investing: Total Contributions", isCurrency: true },
      { label: "Investing: Investment Gains", isCurrency: true },
      { label: "Recommended Strategy", isCurrency: false },
      { label: "Wealth Difference", isCurrency: true },
    ],
    calculate: (data: any) => {
      const mortgageBalance = Number(data.mortgageBalance) || 0;
      const annualRate = Number(data.interestRate) / 100 || 0;
      const yearsRemaining = Number(data.yearsRemaining) || 0;
      const extraMonthlyPayment = Number(data.extraMonthlyPayment) || 0;
      const investmentReturn = Number(data.investmentReturn) / 100 || 0;
      const taxBracket = Number(data.taxBracket) / 100 || 0;
      const itemizeDeductions = data.itemizeDeductions;
      
      const monthlyRate = annualRate / 12;
      const months = yearsRemaining * 12;
      
      // Calculate current monthly payment
      const monthlyPayment = mortgageBalance * (monthlyRate * Math.pow(1 + monthlyRate, months)) / (Math.pow(1 + monthlyRate, months) - 1);
      
      // Calculate total interest without extra payments
      const totalPaidNormal = monthlyPayment * months;
      const totalInterestNormal = totalPaidNormal - mortgageBalance;
      
      // Calculate with extra payments
      let balance = mortgageBalance;
      let monthsPaid = 0;
      let totalPaidWithExtra = 0;
      
      while (balance > 0 && monthsPaid < months) {
        const interestPayment = balance * monthlyRate;
        const principalPayment = monthlyPayment - interestPayment + extraMonthlyPayment;
        totalPaidWithExtra += monthlyPayment + extraMonthlyPayment;
        balance -= principalPayment;
        monthsPaid++;
      }
      
      const totalInterestWithExtra = totalPaidWithExtra - mortgageBalance;
      const interestSaved = totalInterestNormal - totalInterestWithExtra;
      const yearsSaved = (months - monthsPaid) / 12;
      
      // After-tax effective rate
      const effectiveRate = itemizeDeductions ? annualRate * (1 - taxBracket) : annualRate;
      
      // Investment calculation
      const monthlyInvestmentReturn = investmentReturn / 12;
      const investmentMonths = months;
      const investmentValue = extraMonthlyPayment * ((Math.pow(1 + monthlyInvestmentReturn, investmentMonths) - 1) / monthlyInvestmentReturn) * (1 + monthlyInvestmentReturn);
      const totalContributions = extraMonthlyPayment * investmentMonths;
      const investmentGains = investmentValue - totalContributions;
      
      // Recommendation
      let recommendation = "";
      let wealthDifference = 0;
      
      // Compare: Interest saved vs Investment gains
      if (investmentGains > interestSaved) {
        recommendation = "INVEST - Higher expected return";
        wealthDifference = investmentGains - interestSaved;
      } else {
        recommendation = "PAY OFF MORTGAGE - Better risk-adjusted return";
        wealthDifference = interestSaved - investmentGains;
      }
      
      // Adjust recommendation based on risk factors
      if (effectiveRate > 0.06) {
        recommendation = "PAY OFF MORTGAGE - High interest rate";
      } else if (effectiveRate < 0.04 && yearsRemaining > 15) {
        recommendation = "INVEST - Low rate, long timeline";
      }

      return [
        { label: "Mortgage: Interest Saved by Extra Payments", value: interestSaved.toFixed(2), isCurrency: true },
        { label: "Mortgage: Years Saved", value: yearsSaved.toFixed(1), isCurrency: false },
        { label: "Mortgage: Total Paid with Extra Payments", value: totalPaidWithExtra.toFixed(2), isCurrency: true },
        { label: "Mortgage: After-Tax Effective Rate (%)", value: (effectiveRate * 100).toFixed(2), isCurrency: false },
        { label: "Investing: Account Value at End", value: investmentValue.toFixed(2), isCurrency: true },
        { label: "Investing: Total Contributions", value: totalContributions.toFixed(2), isCurrency: true },
        { label: "Investing: Investment Gains", value: investmentGains.toFixed(2), isCurrency: true },
        { label: "Recommended Strategy", value: recommendation, isCurrency: false },
        { label: "Wealth Difference", value: wealthDifference.toFixed(2), isCurrency: true },
      ];
    },
  },
};
